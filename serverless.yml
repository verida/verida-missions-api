service: airdrop-api

custom:
  serverless-offline:
    httpPort: 5022
    noPrependStageInUrl: true
    useChildProcesses: true
  customDomain:
    domainName: rewards.myrtle.verida.tech
    basePath: ""
    certificateName: "*.myrtle.verida.tech"
    endpointType: regional
    createRoute53Record: true
    apiType: http
  webpack:
    includeModules: true
    packagerOptions:
      scripts:
        - npm_config_platform=linux npm_config_arch=x64 yarn add leveldown

provider:
  name: aws
  runtime: nodejs20.x
  stage: prod
  region: us-east-1

functions:
  app:
    handler: build/server.handler
    events:
      - httpApi:
          path: "/{proxy+}"
          method: "*"

plugins:
  - serverless-dotenv-plugin
  - serverless-offline
  - serverless-domain-manager
  - serverless-plugin-common-excludes
  - serverless-plugin-include-dependencies

package:
  patterns:
    - "!node_modules/**"
